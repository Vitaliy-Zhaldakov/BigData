olympics <- read.csv(file = "C:/Users/vzhal/OneDrive/??????? ????/????????? ??????? ??????/Athlet_Events/athlete_events.csv", 
                   sep = ",", header = TRUE, dec = ',')

#----------------------------------------------------------------------
# ?????????? ?? ???????
tennis_athlets <- subset(olympics, Sport == 'Tennis')

# ??? ???????????
weight <- as.numeric(tennis_athlets$Weight)

# ???????? ??????????? ??????
# na <- is.na(weight)
# good_weight <- weight[!na]

# ??????????? ????
hist(weight, main='??? ???????????',
     xlab='???', ylab='???????')

# ???????? ??????? ?? ???????????? ? ??????? ??????????-???????????? ???????
# (?????????? ????????????? ?????? ???????????? ?????????? ??????????? ?????????????)
qqnorm(weight)
qqline(weight, col='red')

install.packages('car')
library(car)
qqPlot(weight)

# ???? ?????????
t.test(weight, mu=65)

# ???? ??????????
wilcox.test(weight, mu=65, conf.int = TRUE)

# ???? ??????-??????, ???????? ?? ???????????? ?????????????
shapiro.test(weight)

#-----------------------------------------------------------------------------------------
# ??????? ?????? ??????????? ? ???????
tennis_swimming_men <- subset(olympics, Sex == 'M' & (Sport == 'Tennis' | Sport == 'Swimming'))

weight <- as.numeric(tennis_swimming_men$Weight)

# ??????????? ???????
hist(weight, main='??????????? ??????????? ? ???????', xlab='???')

# ???????? ?? ????????????
qqPlot(weight)

tennis_weight <- as.numeric(subset(olympics, Sex == 'M' & Sport == 'Tennis')$Weight)
swimming_weight <- as.numeric(subset(olympics, Sex == 'M' & Sport == 'Swimming')$Weight)

mean(tennis_weight, na.rm=TRUE)
mean(swimming_weight, na.rm = TRUE)

# ???? ?? ????????? ?????????
bartlett.test(as.numeric(tennis_swimming_men$Weight) ~ tennis_swimming_men$Sport, data=tennis_swimming_men)

# ????????, ??????????? ?? ??????? ??? ? ??????????? ? ???????
t.test(as.numeric(tennis_swimming_men$Weight) ~ tennis_swimming_men$Sport)

# ??? ???????, ??? ????????? ???????? ?????
t.test(as.numeric(tennis_swimming_men$Weight) ~ tennis_swimming_men$Sport, paired = FALSE, var.equal = TRUE)
