data(mtcars)

cars <- mtcars[,-c(2,8,9,10)]

maxs <- apply(cars, 2, max)
mins <- apply(cars, 2, min)

cars <- scale(cars, center = mins, scale = maxs - mins)

names <- c("?????? (??????? ???? ?? ??????)", "????? ?????????", "????????", "???????????? ????? ??????? ????????", "???",
           "?????????", "????? ????????????")

# ??????? ???????? ?????????? (?? ????????? - ????????? ??????????)
dist_cars <- dist(cars)

# ?????????? ??????
clust_cars <- hclust(dist_cars, "ward.D")

# ?????????? ????????????
plot(clust_cars, labels = rownames(mtcars), cex=0.5, 
     main="???????????? ?????????",
     xlab="?????")
rect.hclust(clust_cars, k = 4, border = "blue")

# ????????? ???????????? ?? ????????
groups <- cutree(clust_cars, k = 4)

cars[groups==1, 1]
cars[groups==2, 1]
cars[groups==3, 1]
cars[groups==4, 1]

# ????????? ??????? ???????? ??????????? ? ?????? ????????
#  ? 1-?? ????????
g1<-colMeans(cars[groups==1,])
#  ?? 2-?? ????????
g2<-colMeans(cars[groups==2,])
#  ? 3-?? ????????
g3<-colMeans(cars[groups==3,])
#  ?? 4-?? ????????
g4<-colMeans(cars[groups==4,])

# ?????????? ?????????? ?????????
df <- data.frame(g1,g2,g3,g4)
rownames(df) <- names
colnames(df) <- c('???????', "D ?????", "A ?????", "??????????")
barplot(data.matrix(df), main="?????? ???????????", col=rainbow(7), ylim = c(0,1.5), beside = TRUE)
legend("topright", names, col=rainbow(7), lwd=5, bty = "n",  y.intersp = 0.4, text.width = 10)

library(lattice)

# ????????? ????????? ?????????
# ??????????? ???????? ????????? ?? ???????
xyplot(hp ~ mpg, mtcars, main='??????????? ???????? ????????? ?? ???????',
       xlab='?????? ??????? (????? ???? ?? ??????)', ylab='???????? ?????????')

xyplot(hp+disp ~ mpg, mtcars, auto.key = TRUE, main="??????????? ??????? ?? ???????? ? ?????? ?????????",
       xlab="?????? ??????? (????? ???? ?? ??????)",
       ylab="???????? + ????? ?????????")

library(car)
# ????????? ?????????
scatterplotMatrix(cars, spread=FALSE, lty.smooth=2,
                  main='??????? ???????? ?????????')
